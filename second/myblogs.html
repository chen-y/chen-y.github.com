<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,maximum-scale=1.0">
<title>myblogs</title>
<link rel="stylesheet" href="../css/common.css" />
<link rel="stylesheet" href="../css/iconfont.css" />
<link rel="stylesheet" href="../css/myblogs.css" />
<style>
</style>
</head>

<body>
<div class="header">
	<div class="column clearfix">
    	<a class="iconfont blogs" href="javascript:;">&#xe636;Blogs</a>
    	<a target="_blank" class="iconfont" href="../index.html">&#xe601;首页</a>
    	<a target="_blank" class="iconfont" href="data.html">&#xe609;个人资料</a>
    	<a target="_blank" class="iconfont" href="skills.html">&#xe613;技能</a>
    	<a target="_blank" class="iconfont" href="javascript:;">&#x3433;微信</a>
    	<a target="_blank" class="iconfont floatRight" href="javascript:;">&#xe75f;QQ</a>
        <a target="_blank" class="floatRight" href="data.html">陈意</a>
    </div>
</div>
<div class="content">
	<div class="nav">
    	<div class="user">谁谁的博客</div>
        <div class="nav-content">
        	<div class="">
            	 <a class="Mleft" href="data.html">关于我</a>
                 <a href="javascript:;">相册</a>
                 <a href="javascript:;">微博</a>
                <a class="check" href="javascript:;">博客</a>
                
               
               
            </div>
        </div>
    </div>
    <div class="client clearfix">
    	<div class="aside">
        	<h3 class="logo">
            	<img src="../img/myPohot.png" alt="" />
            </h3>
            <span class="nickname">chenyi</span>
            <div class="data">
            	<div class="sex">性别:&nbsp;男</div>
                <div class="form">来自:&nbsp;湖北</div>
                <div class="see">浏览:&nbsp;15486200</div>
            </div>
            <div class="article">
            	<h3 class="title">文章分享</h3>
                <ul class="list">
                	<li><a href="javascript:;">jsp端自动下载并保存图片文件</a></li>
                	<li><a href="javascript:;">oop的那点事</a></li>
                </ul>
            </div>
            <div class="visitor clearfix">
            	<div class="lately">最近访客</div>
                <div class="more">更多访客>></div>
                <ul class="visitorData clearfix">
                	<li><a href="javascirpt:;"><img src="../img/red.png" />lili</a></li>
                	<li><a href="javascirpt:;"><img src="../img/pink.png" />albb</a></li>
                	<li><a href="javascirpt:;"><img src="../img/yellow.png" />tttttb</a></li>
                	<li><a href="javascirpt:;"><img src="../img/write.png" />123a456</a></li>
                </ul>
            </div>
        </div>
        <div class="contentArea">
        	<ul>
            	<li>
                    <h3>jsp端自动下载并保存图片文件</h3>
                    <p class="Text">JScript code<br/> 
//js自动下载文件到本地<br/>  
var xh;<br/>  
function getXML(geturl) { <br/> 
    &nbsp;&nbsp;//alert("ll"); <br/> 
    &nbsp;&nbsp;xh = new ActiveXObject("Microsoft.XMLHTTP"); <br/> 
    &nbsp;&nbsp;xh.onreadystatechange = getReady; <br/> 
    &nbsp;&nbsp;xh.open("GET",geturl,true); <br/>                    
    &nbsp;&nbsp;xh.send();<br/>                          
} <br/> 

function getReady() { <br/> 
    &nbsp;&nbsp;alert(xh.readyState);<br/>  
    &nbsp;&nbsp;if(xh.readyState==4)  { <br/> 
        &nbsp;&nbsp;&nbsp;if(xh.status==200){ <br/> 
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;saveFile("d:\mm.exe");<br/>  
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return true; <br/> 
        &nbsp;&nbsp;&nbsp;} else {<br/> 
        
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return false;<br/> 
        
       &nbsp;&nbsp;}else{ <br/>
       &nbsp;&nbsp;&nbsp;&nbsp;return false; 
    &nbsp;&nbsp;<br/> &nbsp;&nbsp;}  
        <br/> 
} <br/> 

function saveFile(tofile){<br/> 
    &nbsp;&nbsp;var objStream; <br/> 
    &nbsp;&nbsp;var imgs; <br/> 
    &nbsp;&nbsp;imgs = xh.responseBody; <br/> 
    &nbsp;&nbsp;objStream = new ActiveXObject("ADODB.Stream"); <br/> 
    &nbsp;&nbsp;objStream.Type = 1; <br/> 
    &nbsp;&nbsp;objStream.open(); <br/> 
    &nbsp;&nbsp;objStream.write(imgs); <br/> 
    &nbsp;&nbsp;objStream.SaveToFile(tofile) <br/> 
} <br/> 
getXML("http://192.168.22.206/servlet"); 

</p>
                </li>
            </ul>
        </div>
    </div>
</div>
<div class="footer"></div>
</body>
</html>
